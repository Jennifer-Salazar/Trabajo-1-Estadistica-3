---
title: "Borrador"
author: "Jennifer Salazar"
output: powerpoint_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Falta hacer esto

Defina la variable de la serie, su unidad de medida, su construcci칩n e interpretacion de sus cifras, per췂캼odos observados, frecuencia de observaci췂on, total de observaciones y fuente de los datos.



# Librerias utiles

```{r}
library(forecast)
library(TSA)
library(fANCOVA)
```



```{r}
Datos20
```


# 2. Analisis descriptivo de la serie y modelos propuestos:



```{r}
plot(Datos20)
```



## Descomposici칩n aditiva (tendencia)

* La serie es de componentes aditivas dado que su varianza es constante alrededor de su trayectoria de largo plazo(tendencia).


```{r}
Tt=decompose(Datos20)$trend
plot(Tt,ylim=c(min(Datos20),max(Datos20)))
```

* es visible que la serie es de tendencia creciente y que existen ciclos.


##  grafico de boxplots comparativos de la distribucion de la serie versus per캼odos del a침o calendario


```{r}
boxplot(Datos20~cycle(Datos20), names=month.abb)
grid()
```

* vemos c칩mo la media en particular la mediana de la distribuci칩n de la serie seg칰n periodo del a침o, cambia a lo largo de un a침o calendario siendo menor en los meses de enero, febrero, abril y diciembre comparados con el resto del a침o. Tiene un crecimiento de enero a marzo y luego vuelve y baja en abril  para volver a subir en mayo manteniendose relativamente al mismo nivel en los siguientes meses hasta noviembre, para luego decaer en diciembre y retormar el siguiente a침o.


## Periodograma


```{r}
periodogram(diff(Datos20),lwd=4) #periodograma sobre los logaritmos diferenciados
abline(v=c(1:6)/12,col=2,lty=2)
grid()
```


el periodograma muestra la asociacion de la serie con cinco componentes periodicas (por valor alto del periodograma en esas frecuencias): en las frecuencias 1/12 y 2/12, 3/12, 4/12, 6/12.


# justifique por que existe componente estacional y si su forma es constante o no en el tiempo. 

- Mediante el gr치fico de la serie vs el tiempo se ve un patr칩n que se repite cada a침o; pues en cada a침o se observa que en los meses del inicio y del final el 칤ndice de producci칩n nominal es bajo y tiene aproximadamente 2 picos de decaimiento en el transcurso del a침o.

- Dado que en el gr치fico de boxplot al menos una de las medias de los meses cambia respecto al resto de los meses del a침o calendario, por lo tanto se concluye que cada periodo en que se divide el a침o calendario determina una estaci칩n, la cual tiene incidencia sobre el valor medio de la serie, por ellos se dice que existe la componente estacional.

- Mediante el periodograma se resalta que hay una asociaci칩n de la serie con fenomenos periodicos, indicando la existencia de una componente estacional.


## Es la estacionalidad constante o no en el tiempo:

```{r}
par(mfrow=c(2,2))
plot(Datos20, xlim=c(2001,2005))
plot(Datos20, xlim=c(2006,2010))
plot(Datos20, xlim=c(2011,2015))
plot(Datos20, xlim=c(2016,2019))

```

Estamos en desacuerdo, lo respondemos m치s tarde.

## la tendencia se puede ajustar globalmente o si es local.

- La tendencia de la serie es global ya que se puede ajustar una curva suave creciente en todos los tiempos de la serie, Tambi칠n se puede ajustar modelos locales para comparar los ajustes y pronosticos respecto a la ajuste global.



##  identificacion de posibles ciclos y cambios estructurales.

* Hay presencia de ciclos en la serie a tr치ves del tiempo ya que al aplicar la descomposici칩n aditiva y obtener la tendencia, no se observa una curva suave que describa la tendencia de la serie.
* Hay aproximadamente entre 4 y 5 ciclos en la serie a trav칠s del tiempo (monta침as).
* No hay presencia de cambios estructurales en la serie.




#################################################################################


# Modelos propuestos




Por el an치lisis descriptivo, para los modelos globales la tendencia puede ser ajustada por un polinomio de grado $p = 2, 3$ y la componente estacional puede representarse como un factor y por tanto usar  variables indicadoras en los modelos globales. Se proponen los siguientes modelos de regresi칩n, donde t es el 칤ndice de tiempo y $I_{i,t}$ es la indicadora del trimestre i en el tiempo t.


## Modelo 1: Modelo cuadr치tico estacional con indicadoras, mes de referencia diciembre

$$Y_t=\beta_0+\beta_1t+\beta_2t^2+\sum_{i=1}^{11}\delta_iI_{i,t}+E_t, ~~~ E_t \sim iid N(0, \sigma^2)$$

## Modelo 2: Modelo c칰bico estacional con indicadoras, mes de referencia diciembre

$$Y_t=\beta_0+\beta_1t+\beta_2t^2+\beta_3t^3+\sum_{i=1}^{11}\delta_iI_{i,t}+E_t, ~~~ E_t \sim iid N(0, \sigma^2)$$

## Modelos 3: Descomposici칩n aditiva & Loess cuadr치tico

En la vecindad de un tiempo $t_k$ donde se quiere ajustar, $Y_t = \beta_{0,k} + \beta_{1,k}t + \beta_{2,k}t^2 + \sum_{i=1}^{12}\delta_i I_{i,t} +  E_t, ~~ E_t \sim iid N(0,\sigma^2)$ para todo t vecino a $t_k$, con $\sum_{i=1}^{12}\delta_i=0,~~~ \beta_{0,k},~\beta_{1,k}~y~\beta_{2,k}$ los parametros de la parabola local en la vecindad de $t_k$


## Modelo 4: Suavizamiento exponencial Holt-Winters aditivo

$Y_{t+h} = \beta_{0,t} + \beta_{1,t}\times h + \sum_{i=1}^{12}\delta_{i,t} I_{i,t+h} +  E_{t+h}, ~~ E_t \sim iid N(0,\sigma^2)$, con $\sum_{i=1}^{12}\delta_{i,t}=0,~~\beta_{0,t}~y~\beta_{1,t}~y~\delta_{i,t}$, el nivel en $t$, la pendiente en $t$ y los efectos estacionales en $t$, respectivamente, cambiando lentamente en el tiempo.




## Ajuste de los modelos con validaci칩n cruzada


```{r}
m <- 12 # numero de periodos a pronosticar dentro de la muestra
n <-length(Datos20)-m # tama침o de la muestra para el ajuste
t <- 1:n #Indice de tiempo en los periodos de ajuste
```


* Datos para el ajuste:

```{r}
yt <- ts(Datos20[t], frequency = 12, start=c(2001, 1))
```


* Definiendo factor para estacionalidad pero solo para la regresion lineal modelo 1

* Creaci칩n de las variables indicadoras para los datos de muestra
```{r}
mes <- seasonaldummy(yt) #Matriz con las 11 primeras variables Indicadoras mes


#Separando una a una las 11 variables indicadoras

I1 <- mes[,1]
I2 <- mes[,2]
I3 <- mes[,3]
I4 <- mes[,4]
I5 <- mes[,5]
I6 <- mes[,6]
I7 <- mes[,7]
I8 <- mes[,8]
I9 <- mes[,9]
I10 <- mes[,10]
I11 <- mes[,11]
```


* Creaci칩n de las variables indicadoras para los datos de validaci칩n cruzada


```{r}
tnuevo <- (n+1):length(Datos20)
ytnuevo <- ts(Datos20[tnuevo], frequency = 12, start = c(2019, 1))


mesnuevo <- seasonaldummy(yt, h=12)
#Separando una a una las 11 indicadoras para los tiempos de pron?stico
I1n=mesnuevo[,1]
I2n=mesnuevo[,2]
I3n=mesnuevo[,3]
I4n=mesnuevo[,4]
I5n=mesnuevo[,5]
I6n=mesnuevo[,6]
I7n=mesnuevo[,7]
I8n=mesnuevo[,8]
I9n=mesnuevo[,9]
I10n=mesnuevo[,10]
I11n=mesnuevo[,11]
```



## Ajuste del modelo 1 Modelo cuadr치tico estacional con indicadoras


```{r}
mod1 <- lm(yt~t+I(t^2)+I1+I2+I3+I4+I5+I6+I7+I8+I9+I10+I11)
summary(mod1)
```


## Ajuste del modelo 2 Modelo c칰bico estacional con indicadoras


```{r}
mod2 <- lm(yt~t+I(t^2)+I(t^3)+I1+I2+I3+I4+I5+I6+I7+I8+I9+I10+I11)
summary(mod2)
```


## Funciones a utilizar:

```{r}
#Creando funci칩n para extraer correctamente estimaciones de los efectos estacionales 洧럋洧눍 por filtro de descomposici칩n
factoresdeltai=function(descom,s,estacionini){
if(estacionini==1){
deltasi=descom$figure
}
if(estacionini!=1){
j=estacionini;deltasi=c(descom$figure[(s-j+2):s],descom$figure[1:(s-j+1)])
}
deltasi
}
```


## Ajuste modelo 3 Descomposici칩n aditiva & Loess cuadr치tico


```{r}
#Descomposici칩n aditiva de la serie recortada
descom=decompose(yt,type="additive")
```



```{r}
s=12 #Longitud del periodo estacional
```



```{r}
#Componente estacional estimada de la descomposici칩n de la serie recortada
St=descom$seasonal


deltas_i=factoresdeltai(descom=descom,s=12,estacionini=1) #Obteniendo los s factores estacionales estimados


#el per칤odo es s=12 y la serie arranca en estaci칩n 1
data.frame(deltas_i)
```



```{r}
#Pron칩sticos para la componente estacional usando estimaciones del filtro de descomposici칩n cl치sica

#los pron칩sticos inician en enero 2019 y terminan en diciembre 2019

i=c(1,2,3,4,5,6,7,8,9,10,11,12) #identificando la estaci칩n correspondiente a los m=12 per칤odos de pron칩sticos
```




```{r}
Stnuevo=deltas_i[i] #Asignando el valor de St a los periodos a pronosticar
Stnuevo=ts(Stnuevo,frequency=12,start=c(2019,1)) #convirtiendo en serie de tiempo al pron칩stico de St
Stnuevo
```

```{r}
#Desestacionalizando o ajustando estacionalmente a la serie recortada, seg칰n modelo aditivo
ytd=yt-St
```



```{r}
#LOESS cuadr치tico (AICC) sobre serie desestacionalizada
mod3=loess.as(t,ytd,degree=2,criterion="aicc",family="gaussian",plot=F)
summary(mod3)
alfa.optim2=mod3$pars$span #guardando el valor 칩ptimo del par치metro alfa
```




## Ajuste modelo 4 con m칠todo Suavizamiento exponencial Holt-Winters aditivo

### Modelo de tendencia con cambio de nivel y pendiente, aditiva a factor estacional con efectos que evolucionan lentamente en el tiempo

```{r}
mod4=HoltWinters(yt,seasonal="additive") #Suavizamiento con valores ?ptimos en par?metros 洧럈, 洧량, 洧럊
mod4
```


# Valores ajustados de los modelos 


Modelo 1

```{r}
mod1_ajust <- ts(fitted(mod1), start  = c(2001,1), frequency = 12)
```


```{r}
plot(Datos20)
lines(mod1_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste del modelo1"), lty=1, col=c(1,2))

```

Modelo 2

```{r}
mod2_ajust <- ts(fitted(mod2), start  = c(2001,1), frequency = 12)
```


```{r}
plot(Datos20)
lines(mod2_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste del modelo2"), lty=1, col=c(1,2))

```

modelo 3

```{r}
mod3_Tt <- ts(fitted(mod3), start  = c(2001,1), frequency = 12)
mod3_ajust <- mod3_Tt + St # Ajuste D&LC(AICC)
```


```{r}
plot(Datos20)
lines(mod3_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste D&LC(AICC)"), lty=1, col=c(1,2))

```




Modelo 4

```{r}
mod4_ajust <- fitted(mod4)[,1]
plot(Datos20)
lines(mod4_ajust, col=2, lwd=2)
legend("topleft", legend=c("Original","Ajuste H-W"), col=c(1,2), lty=1)
```

# Calculo del AIC y BIC

```{r}
#Creando funci?n usuario crit.inf.resid() para calcular C^*_n(p)
crit.inf.resid <- function(residuales,n.par,AIC="TRUE"){
if(AIC=="TRUE"){
#Calcula AIC
CI=log(mean(residuales^2))+2*n.par/length(residuales)
}
if(AIC=="FALSE"){
#Calcula BIC
CI=log(mean(residuales^2))+n.par*log(length(residuales))/length(residuales)
}
CI
}  
```

modelo 1
```{r}
resmod1.orig <- residuals(mod1) #seudo-residuos en la escala original. Usados s?lo para calcular AIC y BIC

npar1 <- length(coef(mod1)[coef(mod1)!=0]) #n?mero par?metros modelo 1

aic1 <- exp(crit.inf.resid(resmod1.orig,n.par=npar1))
bic1 <- exp(crit.inf.resid(resmod1.orig ,n.par=npar1, AIC="FALSE"))
```

modelo 2
```{r}
resmod2.orig <- residuals(mod2) #seudo-residuos en la escala original. Usados s?lo para calcular AIC y BIC

npar2 <- length(coef(mod2)[coef(mod2)!=0]) #n?mero par?metros modelo 1

aic2 <- exp(crit.inf.resid(resmod1.orig,n.par=npar2))
bic2 <- exp(crit.inf.resid(resmod1.orig ,n.par=npar2, AIC="FALSE"))
```

modelo 3
```{r}
et3 <- yt - mod3_ajust

p3 <- round(mod3$enp)+s-1
AIC3 <- exp(crit.inf.resid(residuales=et3,n.par=p3))
BIC3 <- exp(crit.inf.resid(residuales=et3,n.par=p3,AIC="FALSE"))
```

modelo 4
```{r}
p4 <- (s-1)+2 #Aprox. del n?mero de par?metros del suavizamiento
AIC4 <- exp(crit.inf.resid(residuales=residuals(mod4),n.par=p4))
BIC4 <- exp(crit.inf.resid(residuales=residuals(mod4),n.par=p4,AIC="FALSE"))
```





# Preguntas orientadas para los analisis
## hacer tablas de los summary

 * En los modelos globales 쯉on significativos el polinomio considerado y la componente estacional con la representaci칩n que fue usada?

Modelo 1

Debido a que el valor ajustado para el coeficiente correspondiente al grado 2 del polinomio tiene un p-valor muy peque?o(menor a 0.05), se dice que es significativo y por lo tanto la estructura del polinomio cuadratico es significativa.
Por otro lado, ya que al menos uno de los coeficientes estimados asociados a las variables indicadoras, son significativos(p-valor menor a 0.05), en este caso todos, se concluye que la componente estacional es significativa.

Modelo 2

Debido a que el valor ajustado para el coeficiente correspondiente al grado 3 del polinomio tiene un p-valor grande(mayor a 0.05), se dice que no es significativo y por lo tanto la estructura del polinomio cubico no es significativa.
Por otro lado, ya que al menos uno de los coeficientes estimados asociados a las variables indicadoras, son significativos(p-valor menor a 0.05), en este caso todos, se concluye que la componente estacional es significativa.

En los modelos globales 쮺u치l es la interpretaci칩n de las estimaciones de los par치metros estacionales?, 쯗ifieren mucho estas estimaciones entre los modelos globales? Adem치s, si se modelo con variables indicadoras, grafique en un mismo plano y en la escala original de la serie, el patr칩n estacional estimado 쮼stas estimaciones aproximan apropiadamente el patr칩n estacional? Esta gr치fica puede realizarse de la siguiente manera: Suponga que los modelos son ajustados en R bajo los objetos de nombre mod1 y mod2 respectivamente. Sean p1 y p2 los ordenes de los respectivos polinomios, nparmod1 y nparmod2 el n칰mero de par치metros, de cada
modelo, respectivamente. En el caso aditivo, proceda as칤:

Ya que la serie es aditiva, los $\delta_i$ es la diferencia entre la media de la serie en el mes i del a침o menos la media en el periodo de referencia, es decir, diciembre.


(.............Hacer tabla con las estimaciones de los delta_i y dar m치s conclusiones.....)

```{r}
summary(mod1)
summary(mod2)
```



```{r}
p1 <- 2 # grado del polinomio modelo 1
p2 <- 3 # grado del polinomio modelo 2


efectosestac1 <- ts(c(coef(mod1)[(p1+2):npar1],0),freq=1,start=1)
efectosestac2 <- ts(c(coef(mod2)[(p2+2):npar2],0),freq=1,start=1)
#win.graph()
plot(efectosestac1,lwd=4,ylab="",xlab="Periodo del a침o")
lines(efectosestac2,lty=2,col=2,lwd=4)
legend("topleft",legend=c("Modelo 1","Modelo 2"),col=1:2,lty=1:2,lwd=2)
```


Vemos que el mod1 y el mod2 estiman la misma forma para $S_t$ adem치s de que sus valores son muy similares para los efectos estacionales (no son iguales pero tinen diferencias muy peque침as en las estimaciones de los $\delta_i$)

Como se interpreta??? (...comentar........)



 * Compare gr치ficamente la forma de la estimaci칩n de la componente estacional entre los dos modelos locales(en Holt-Winters se toma el  칰ltimo valor suavizado para cada uno de los 12 efectos estacionales) 쯗ifieren mucho? Adem치s, si en los modelos globales se usaron indicadoras, compare la forma del patr칩n estacional estimado por estos vs. los locales 쯤u칠 se interpreta a partir de la similaridad o diferencia entre estas estimaciones?
 
 
```{r}
#extracci칩n estimaciones en t=216 de efectos estacionales segun Holt-Winters.

deltasiHW=ts(mod4$coef[c(3:14)],freq=1,start=1)#Estimaciones de los efectos estacionales segun filtro de descomposici칩on

deltasDescomp=ts(deltas_i,freq=1,start=1)
deltasilocales=data.frame(rbind(deltasiHW,deltasDescomp),row.names=c("HW","Descomp&loess"))
names(deltasilocales)=c(1:12)#Gr치fico de los efectos estacionales estimados


plot(deltasiHW,lwd=4,ylim=c(min(deltasiHW,deltasDescomp),max(deltasiHW,deltasDescomp)+0.05),ylab="",xlab="Mes del a침o")
lines(deltasDescomp,lty=2,lwd=4,col=2)
legend("topleft",legend=c("Efectos estacionales H-W en t=216","Efectos estacionales Filtro de descomposici칩n"),col=1:2,lty=1:2,lwd=3)
```


* Se observa que hay algunas diferencias entre las estimaciones "globales" que da el filtro con respecto a "la 칰ltima estimaci칩n local" que da SEHW; sin embargo, la "forma del patr칩n" estimado es igual. Por lo tanto, $S_t$ en $Y_t$ es m치s o menos estable en el tiempo.



```{r}
plot(efectosestac1,lwd=4,xlab="Periodo del a침o", ylim =c(-10, 23))
lines(efectosestac2,lty=2,col=2,lwd=4)
lines(deltasiHW,lwd=3, col=3)
lines(deltasDescomp,lty=2,lwd=4,col=4)
legend("topleft",legend=c("Polinomial cuadr치tico","Polinomial c칰bico", "SEHW","DLC"),col=1:4,lwd=3, cex=0.8)
```


* Vemo que los modelos globales estiman la misma forma de $S_t$ pero con valores diferentes de los efectos estacionales al no coindir los $\delta_i$

<br>


Con relaci칩n al ajuste loess de la serie desestacionalizada 쯈u칠 se concluye de su gr치fica y del n칰mero de par치metros equivalentes loess?
 
# GR츼FICOS DE LA SERIE DESESTACIONALIZADA Y SUS AJUSTES LOESS

```{r}
plot(ytd)
lines(mod3_Tt, col=2, lwd = 2)
legend("topleft", legend=c("Serie ajustada estacionalmente", "Tendencia LOESS cuadr치tico (AICC)"), col=c(1,2), lty=1)
``` 


Se observa que los valores ajustados se acercan a los valores que toma la serie; la componente ciclica que toma la serie esta presente ya que se puede observar que la tendencia no es una curva completamente suave. 

Finalmente el ajuste que hace LOESS al final de la serie es creciente, aunque el valor real muestra una tendencia decreciente

Para un ajuste global polinomial alcanzando el mismo ajuste que LOESS, el modelo global deberia ser un polinomial con aproximadamente 13 par치metros.


<br>


쯈u칠 se concluye sobre la calidad del ajuste de los modelos globales vs. locales? tambi칠n determine entre los modelos globales cu치l modelo recomendar칤a inicialmente como mejor modelo global para ajustar la serie. Tenga en cuenta no s칩lo los valores de los criterios de informaci칩n, sino tambi칠n los resultados gr치ficos.





```{r}
par(mfrow=c(2,2))
plot(Datos20)
lines(mod1_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste del modelo1"), lty=1, col=c(1,2), cex=0.5)

plot(Datos20)
lines(mod2_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste del modelo2"), lty=1, col=c(1,2), cex=0.5)

plot(Datos20)
lines(mod3_ajust, col=2, lwd=2)
legend("topleft", legend = c("Original", "Ajuste D&LC(AICC)"), lty=1, col=c(1,2), cex=0.5)

plot(Datos20)
lines(mod4_ajust, col=2, lwd=2)
legend("topleft", legend=c("Original","Ajuste H-W"), col=c(1,2), lty=1, cex=0.5)
```


(....... Colocar la tabla de los AIC y BIC de todos los modelos y sacar una conclusi칩n a partir de el)

* En general mediante los gr치ficos tiene un mejor ajuste los modelos locales que los globales


*  Entre los modelos globales se recomienda el modelo cuadr치tico con indicadoras ya que con un grado menos del polinomio ajusta igual de bien que el c칰bico, por tanto se prefiere por ser un modelo m치s simple (parsimonioso) adem치s que en los ajustes se noto que el grado 3 del polinomio del segundo modelo no es significativo.



# 4. An치lisis de residuales y validaci칩n de supuestos: Para todos los modelos ajustados, globales y locales, realice el an치lisis comparativo de residuales.


Gr치fico de los residuales en el tiempo

```{r}
par(mfrow=c(2,2))

# Residuales vs tiempo mod1
plot.ts(residuals(mod1))
abline(h=c(-2*summary(mod1)$sigma, 0, 2*summary(mod1)$sigma), col=2)
legend("topleft", legend=c("Modelo1"), lty=1, col = 1, lwd=2)


# Residuales vs tiempo mod2
plot.ts(residuals(mod2))
abline(h=c(-2*summary(mod2)$sigma, 0, 2*summary(mod2)$sigma), col=2)
legend("topleft", legend=c("Modelo2"), lty=1, col = 1, lwd=2)


# Residuales vs tiempo mod3
df=n-(round(mod3$enp)+s-1) #Grados de libertad aproximados del ajuste total
MSE3=sum(et3^2)/df #MSE aproximado del ajuste total del modelo 3
plot(et3,ylim=c(min(-2*sqrt(MSE3),et3),max(2*sqrt(MSE3),et3)))
abline(h=c(-2*sqrt(MSE3),0,2*sqrt(MSE3)),col=2)
legend("topleft", legend=c("Modelo3"), lty=1, col = 1, lwd=2)


# Residuales vs tiempo mod4

et4=residuals(mod4)
df4=n-2*s-((s-1)+2)
MSE4=mod4$SSE/df4 #MSE aproximado del ajuste total del Suavizamiento

plot(et4,ylim=c(min(-2*sqrt(MSE4),et4),max(2*sqrt(MSE4),et4)))
abline(h=c(-2*sqrt(MSE4),0,2*sqrt(MSE4)),col=2)
legend("topleft", legend=c("Modelo4"), lty=1, col = 1, lwd=2)



```


```{r}

par(mfrow=c(2,2))
# Residuales vs valores ajustados mod1

plot(fitted(mod1), residuals(mod1))
abline(h=c(-2*summary(mod1)$sigma, 0, 2*summary(mod1)$sigma), col=2)
legend("topleft", legend=c("Modelo1"), lty=1, col = 1, lwd=2)


# Residuales vs valores ajustados mod2

plot(fitted(mod2), residuals(mod2))
abline(h=c(-2*summary(mod2)$sigma, 0, 2*summary(mod2)$sigma), col=2)
legend("topleft", legend=c("Modelo2"), lty=1, col = 1, lwd=2)

# Residuales vs valores ajustados mod3
plot(as.numeric(mod3_ajust),et3,ylim=c(min(-2*sqrt(MSE3),et3),max(2*sqrt(MSE3),et3)))
abline(h=c(-2*sqrt(MSE3),0,2*sqrt(MSE3)),col=2)
legend("topleft", legend=c("Modelo3"), lty=1, col = 1, lwd=2)

# Residuales vs valores ajustados mod4

plot(as.numeric(mod4_ajust),et4,ylim=c(min(-2*sqrt(MSE4),et4),max(2*sqrt(MSE4),et4)))
abline(h=c(-2*sqrt(MSE4),0,2*sqrt(MSE4)),col=2)
legend("topleft", legend=c("Modelo4"), lty=1, col = 1, lwd=2)
```


